<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaft.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>광고 등록</title>
</head>
<body>
<script type="text/javascript">
  function create() {
    var form = $('#createForm')[0];
    var data = new FormData(form);

    $.ajax({
      type: "POST",
      url: "/core/v1/creative/",
      enctype: 'multipart/form-data',
      data: data,
      contentType: false,
      processData: false,
      cache: false
    }).done(function() {
      alert("생성 성공!");
      location.href = "/";
    }).fail(function(err) {
      var respErr = err.responseJSON;
      console.log(respErr);
      if(respErr.status === 400){
        if(respErr.errors.length === 0) {
          alert("종료일시가 시작일시보다 과거의 시간이면 안됩니다");
        } else {
          var errors = respErr.errors;
          var str = "입력값 오류 목록\n";
          for(var i = 0; i < errors.length; i++) {
            str += "- " + errors[i].field + "칸이 " + errors[i].reason + "\n";
          }
          alert(str);
        }
      } else {
        alert(err.responseJSON.message);
      }
    })
  }
</script>
<div>
  <form id="createForm">
    <fieldset>
      <table>
        <tr>
          <th>제목</th>
          <td><input type="text" name="title" required="required"></td>
        </tr>
        <tr>
          <th>낙찰가</th>
          <td><input type="number" name="price" required="required"></td>
        </tr>
        <tr>
          <th>이미지파일</th>
          <td><input type="file" name="images" required="required"></td>
        </tr>
        <tr>
          <th>시작일자</th>
          <td><input type="datetime-local" name="advertiseStartDate" required="required"></td>
        </tr>
        <tr>
          <th>종료일자</th>
          <td><input type="datetime-local" name="advertiseEndDate" required="required"></td>
        </tr>
        <tr>
          <td> <input type="button" value="등록" onclick="create()"> </td>
        </tr>
      </table>
    </fieldset>
  </form>
</div>
<a href="/">광고 목록</a>
</body>
</html>